<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="../IMG/JD_Web_Solutions.ico">
  <title>Weekplanner – School</title>
  <script>
    (function () {
      try {
        var pref = localStorage.getItem('app.theme') || 'system';
        var final = pref === 'system'
          ? (window.matchMedia && matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
          : pref;
        document.documentElement.setAttribute('data-theme', final);
      } catch (e) {}
    })();
  </script>
  <!-- Gedeelde CSS -->
  <link rel="stylesheet" href="../CSS/main.css" />
  <link rel="stylesheet" href="../CSS/components-menu.css" />
  <link rel="stylesheet" href="../CSS/components-sidemenu.css" />
  <!-- Pagina CSS -->
  <link rel="stylesheet" href="../CSS/page-planner.css" />
</head>
<body class="planner-page">
  <!-- AUTH -->
  <div id="auth"><button id="login-btn">🔐 Inloggen met Google</button></div>

  <!-- gedeelde header -->
  <div data-include="../partials/header.html"></div>

  <!-- APP -->
  <div id="app" style="display:none;">
    <div class="page">
      <main class="content">
        <!-- Weekkop met navigatie en print -->
        <section class="card headbar">
          <div class="week-nav">
            <button id="prevWeek" class="ghost">◀ Vorige</button>
            <h2 id="weekTitle">Week</h2>
            <button id="nextWeek" class="ghost">Volgende ▶</button>
          </div>
          <div class="printbar">
            <input id="printStart" type="date" />
            <span>—</span>
            <input id="printEnd" type="date" />
            <button id="printList" class="primary">🖨️ Afdruk (lijst)</button>
            <button id="quickPlanBtn" class="ghost">➕ Snel plannen</button>

          </div>
        </section>

        <!-- Kalender -->
        <section class="card">
          <div id="calendar" class="calendar" aria-label="Weekrooster" role="grid"></div>
        </section>
      </main>

      <!-- Backlog rechts -->
      <aside class="rightcol">
        <section class="card backlog">
          <div class="backlog-head">
  <h3>Backlog (vakken)</h3>
  <div style="display:flex; gap:.5rem;">
    <button id="manageSubjectsBtn" class="ghost">Vakken beheren</button>
    <button id="newBacklogBtn" class="primary">＋ NIEUW</button>
  </div>
</div>
          <div id="backlogGroups" class="backlog-groups" aria-live="polite"></div>
        </section>
      </aside>
    </div>
  </div>

  <!-- Gedeelde modals via partials (algemene modals) -->
  <div data-include="../partials/modals.html"></div>

<!-- Backlog-item aanmaken/bewerken -->
<div id="modal-backlog" class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modal-backlog-title" hidden>
  <div class="modal-header">
    <h3 id="modal-backlog-title">Nieuw item</h3>
    <input id="bl-id" type="hidden" />

    <button class="modal-close" data-modal-close="modal-backlog" aria-label="Sluiten">✕</button>
  </div>

  <div class="modal-body">
    <div class="form-grid">

      <!-- VAK (met custom dropdown en kleur-chip) -->
      <label for="bl-subject">Vak</label>
      <div class="subj-wrap">
        <input id="bl-subject" placeholder="bv. Wiskunde" autocomplete="off" />
        <span id="bl-subject-chip" class="chip" hidden>
          <span class="dot"></span><span class="txt"></span>
        </span>
        <div id="bl-subject-menu" class="subj-menu" hidden></div>
      </div>

      <!-- TYPE (drukknoppen + hidden input) -->
   <span id="bl-type-label" class="form-label">Type</span>
<input id="bl-type" type="hidden" value="taak" />
<div class="type-group" role="group" aria-labelledby="bl-type-label">
  <button type="button" class="type-btn is-active" data-type="taak">📝 Taak</button>
  <button type="button" class="type-btn" data-type="toets">🧪 Toets</button>
  <button type="button" class="type-btn" data-type="andere">📚 Andere</button>
</div>


      <!-- TITEL / ONDERWERP -->
      <label for="bl-title">Titel / onderwerp</label>
      <input id="bl-title" placeholder="bv. Hoofdstuk 3 – Breuken" />

      <!-- DUUR (uren) -->
      <label for="bl-duration">Duur (uren)</label>
      <input id="bl-duration" type="number" min="0.5" step="0.5" value="1" inputmode="decimal" />

      <!-- DEADLINE -->
      <label for="bl-due">Deadline (tegen wanneer)</label>
      <input id="bl-due" type="date" />

      <!-- Let op: GEEN kleurveld hier; kleur komt uit gekozen vak -->
    </div>
  </div>

  <div class="modal-footer">
    <button id="bl-save" class="primary">💾 Opslaan</button>
    <button class="ghost" data-modal-close="modal-backlog">Annuleren</button>
  </div>
<label style="margin-right:auto; display:flex; align-items:center; gap:.4rem;">
  <input id="bl-propagate" type="checkbox" checked />
  <span>Ook alle geplande blokken van dit item updaten</span>
</label>

</div>


  <!-- Vakken beheren -->
<div id="modal-subjects" class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modal-subjects-title" hidden>
  <div class="modal-header">
    <h3 id="modal-subjects-title">Vakken beheren</h3>
    <button class="modal-close" data-modal-close="modal-subjects" aria-label="Sluiten">✕</button>
  </div>
  <div class="modal-body">
<div class="form-grid" style="margin-bottom:.75rem;">
  <label>Vaknaam
    <input id="sub-name" placeholder="bv. Wiskunde" />
  </label>

  <div>
    <div style="font-weight:600;margin-bottom:.25rem;">Kleur (kies 1 van 15)</div>
    <div id="sub-palette" class="palette" style="display:flex;flex-wrap:wrap;gap:.35rem;"></div>
    <div style="margin-top:.35rem;display:flex;align-items:center;gap:.5rem;">
      <span class="muted">Geselecteerd:</span>
      <span id="sub-color-preview" class="badge" style="min-width:76px;display:inline-flex;align-items:center;gap:.4rem;">
        <span class="dot" style="width:14px;height:14px;border-radius:50%;display:inline-block;background:#2196F3;"></span>
        <span id="sub-color-text">#2196F3</span>
      </span>
    </div>
  </div>

  <div style="align-self:end;">
    <button id="sub-save" class="primary">➕ Toevoegen / bijwerken</button>
  </div>
</div>


    <div class="table-wrap" style="max-height:50vh; overflow:auto;">
      <table class="table">
        <thead><tr><th>Vak</th><th>Kleur</th><th style="width:140px;">Acties</th></tr></thead>
        <tbody id="subjectsTable"><tr><td colspan="3" class="muted">Nog geen vakken…</td></tr></tbody>
      </table>
    </div>
    <p class="muted" style="margin-top:.5rem">Tip: wijzigen = pas naam/kleur aan en klik “Opslaan”.</p>
  </div>
  <div class="modal-footer">
    <button class="ghost" data-modal-close="modal-subjects">Sluiten</button>
  </div>
</div>

<!-- Snel plannen -->
<div id="modal-quick" class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modal-quick-title" hidden>
  <div class="modal-header">
    <h3 id="modal-quick-title">Snel plannen</h3>
    <button class="modal-close" data-modal-close="modal-quick" aria-label="Sluiten">✕</button>
  </div>
  <div class="modal-body">
    <div class="form-grid">
      <label for="qp-title">Titel</label>
      <input id="qp-title" placeholder="bv. Basket training" />

      <span id="qp-type-label" class="form-label">Type</span>
      <input id="qp-type" type="hidden" value="andere" />
      <div class="type-group" role="group" aria-labelledby="qp-type-label">
        <button type="button" class="type-btn" data-type="taak">📝 Taak</button>
        <button type="button" class="type-btn" data-type="toets">🧪 Toets</button>
        <button type="button" class="type-btn is-active" data-type="andere">📚 Andere</button>
      </div>

      <label for="qp-start">Van (datum)</label>
      <input id="qp-start" type="date" />

      <label for="qp-end">Tot (datum)</label>
      <input id="qp-end" type="date" />

      <span class="form-label">Weekdagen</span>
      <div class="weekdays" style="display:flex;gap:.4rem;flex-wrap:wrap;">
        <label><input type="checkbox" class="qp-dow" value="1" checked> ma</label>
        <label><input type="checkbox" class="qp-dow" value="2"> di</label>
        <label><input type="checkbox" class="qp-dow" value="3"> wo</label>
        <label><input type="checkbox" class="qp-dow" value="4"> do</label>
        <label><input type="checkbox" class="qp-dow" value="5"> vr</label>
        <label><input type="checkbox" class="qp-dow" value="6"> za</label>
        <label><input type="checkbox" class="qp-dow" value="0"> zo</label>
      </div>

      <label for="qp-time">Tijd</label>
      <input id="qp-time" type="time" value="18:00" step="1800" />

      <label for="qp-dur">Duur (uren)</label>
      <input id="qp-dur" type="number" min="0.5" step="0.5" value="1.5" />
    </div>
  </div>
  <div class="modal-footer">
    <button id="qp-save" class="primary">💾 Inplannen</button>
    <button class="ghost" data-modal-close="modal-quick">Annuleren</button>
  </div>
</div>


  <!-- Print-venster template -->
  <template id="print-template">
    <style>
      body{font-family:system-ui,Segoe UI,Roboto,Arial;}
      h2{margin:.2rem 0 .6rem}
      .day{margin:.4rem 0 .6rem}
      .item{padding:.2rem .4rem;border-bottom:1px solid #ddd}
    </style>
    <h2>Lijst geplande items</h2>
    <div id="print-root"></div>
  </template>

  <!-- SCRIPTS (deze ontbraken) -->
  <script src="../Script/Javascript/include-partials.js"></script>
  <script type="module" src="../Script/Javascript/modal.js"></script>
  <script type="module" src="../Script/Javascript/planner.js"></script>
  <div id="evt-tip" aria-hidden="true"></div>

</body>
</html>
